/* =========================================================
   StreamFlix – GLOBAL
   - Reset, variables, thèmes
   - Header/nav, boutons, helpers
   - Base carte (image directe)
   - Footer
========================================================= */

/* Reset */
*,
*::before,
*::after { box-sizing: border-box; }
html, body { height: 100%; }
body { margin: 0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
img, picture, video, canvas { display: block; max-width: 100%; }
figure {     z-index: 1;
    margin: 0 0 0 -12px;
 }
button, input, select, textarea { font: inherit; }
a { color: inherit; text-decoration: none; }
:focus-visible { outline: 2px solid var(--accent-2); outline-offset: 2px; }

/* Variables */
:root {
  --fs-0: clamp(.94rem, .88rem + .30vw, 1rem);
  --fs-1: clamp(1.10rem, .95rem + .70vw, 1.25rem);
  --fs-2: clamp(1.35rem, 1.05rem + 1.50vw, 1.6rem);
  --fs-3: clamp(1.70rem, 1.10rem + 2.50vw, 2.2rem);
  --fs-4: clamp(2.20rem, 1.20rem + 4.00vw, 3rem);

  --space-1: .5rem;
  --space-2: .75rem;
  --space-3: 1rem;
  --space-4: 1.5rem;
  --space-5: 2rem;
  --space-6: 3rem;

  --bg: #141414;         /* Netflix-like */
  --bg-elev: #181818;
  --bg-muted: #0f0f0f;
  --text: #e6e6e9;
  --text-muted: #b3b3b3;
  --accent: #e50914;
  --accent-2: #ffb703;

  --shadow-sm: 0 1px 2px rgba(0,0,0,.25);
  --shadow-md: 0 8px 24px rgba(0,0,0,.45);
  --shadow-lg: 0 16px 48px rgba(0,0,0,.6);

  --max-w: 1400px;
  --header-h: 56px;
  --header-h-scrolled: 48px;

  /* largeur des posters (rails horizontaux 16:9) */
  --tile-w: 72vw;
  --tile-w-sm: 54vw;
  --tile-w-md: 36vw;
  --tile-w-lg: 24vw;
  --tile-w-xl: 19vw;

  --dur-fast: 120ms;
  --dur-mid: 260ms;
  --dur-slow: 480ms;
  --ease: cubic-bezier(.22,.61,.36,1);
}
html[data-theme="light"]{
  --bg:#f9fafb; --bg-elev:#fff; --bg-muted:#f1f5f9;
  --text:#0b0b0f; --text-muted:#475569;
}
html[data-theme="sepia"]{
  --bg:#0b0a09; --bg-elev:#14110f; --bg-muted:#1a1613;
  --text:#f2e8d5; --text-muted:#cbb69a; --accent:#d97706; --accent-2:#f59e0b;
}

/* Helpers */
.container { width: min(100% - 2rem, var(--max-w)); margin-inline: auto; }
.sr-only { position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0; }
.page { background: var(--bg); color: var(--text); }

/* Header */
.site-header{
  position: sticky; top:0; z-index:50;
  height: var(--header-h);
  display:grid; align-items:center;
  background: linear-gradient(180deg, rgba(0,0,0,.85), rgba(0,0,0,.35) 60%, rgba(0,0,0,0));
  transition: height var(--dur-mid) var(--ease), background var(--dur-mid) var(--ease), box-shadow var(--dur-mid) var(--ease);
}
.page.is-scrolled .site-header, .site-header.is-collapsed {
  height: var(--header-h-scrolled); background: rgba(0,0,0,.85); box-shadow: var(--shadow-sm);
}
.header__inner{
  display:grid; grid-template-columns:auto 1fr auto; gap:1rem; align-items:center;
}
.brand{ display:inline-flex; align-items:center; gap:.5rem; font-weight:900; letter-spacing:.3px; }
.brand__mark{ color:var(--accent); font-size:1.15rem; transform: translateY(-1px); }
.brand__name{ font-family: Unbounded, Inter, sans-serif; font-size:1.15rem; text-transform:uppercase; color:#fff; }

.nav{ display:none; gap:1.25rem; }
.nav__link{ color:#e5e5e5; opacity:.85; font-size:.97rem; transition: opacity var(--dur-fast) var(--ease); }
.nav__link:hover, .nav__link.is-active{ opacity:1; }

.header-actions{ display:inline-flex; align-items:center; gap:.5rem; }
.search{ display:inline-flex; align-items:center; gap:.25rem; background:var(--bg-elev); border:1px solid rgba(255,255,255,.1); padding:.25rem .5rem; border-radius:.4rem; }
.search__input{ border:0; background:transparent; color:var(--text); width:10ch; }

.btn{ cursor:pointer; border:1px solid transparent; border-radius:.35rem; padding:.55rem .85rem; font-weight:700; transition: transform var(--dur-fast) var(--ease), background var(--dur-fast) var(--ease), border-color var(--dur-fast) var(--ease), box-shadow var(--dur-fast) var(--ease); }
.btn:hover{ transform: translateY(-1px); }
.btn:active{ transform: translateY(0); }
.btn--primary{ background:#fff; color:#000; box-shadow:var(--shadow-sm); }
.btn--primary:hover{ box-shadow:var(--shadow-md); }
.btn--ghost{ background: rgba(255,255,255,.2); color:#fff; }
.btn--icon{ background: var(--bg-elev); border:1px solid rgba(255,255,255,.1); padding:.5rem; }
.icon{ display:inline-block; line-height:1; }

.avatar{ padding:0; border:0; background:transparent; border-radius:999px; overflow:hidden; width:36px; height:36px; }
.avatar img{ width:100%; height:100%; object-fit:cover; }
.only-desktop{ display:none; }

/* Base card — images directes, pas de “cases grises” */
.card{
  position:relative;
  display:block;
  overflow:visible;       /* overlay dépasse légèrement si besoin */
  transform-origin:center;
  contain: layout paint;
}
.card__media img{
  width:100%;
  height:auto;
  display:block;
  aspect-ratio: 16/9;     /* override par 2/3 en Top10 dans index.css */
  object-fit: cover;
  border-radius: .6rem;
  box-shadow: var(--shadow-sm);
  transition: transform var(--dur-mid) var(--ease), filter var(--dur-mid) var(--ease), box-shadow var(--dur-mid) var(--ease);
}

/* Overlay hover (lecture, +, like) */
.card__overlay{
  pointer-events: none;
  position:absolute; inset:0;
  border-radius:.6rem;
  background: linear-gradient(180deg, rgba(0,0,0,0) 30%, rgba(0,0,0,.65) 100%);
  opacity: 0; transform: translateY(6px);
  transition: opacity var(--dur-mid) var(--ease), transform var(--dur-mid) var(--ease);
}
.card__actions{
  position:absolute; inset:auto 0 .5rem 0;
  display:flex; gap:.5rem; align-items:center; justify-content:center;
  pointer-events: auto;
}
.card .round{
  width:40px; height:40px; border-radius:999px;
  border:0; background:#fff; color:#000; font-weight:900; display:grid; place-items:center;
  box-shadow: var(--shadow-sm);
}
.card .round + .round{ background: rgba(255,255,255,.85); }
.card .chip{
  color:#fff; border:1px solid rgba(255,255,255,.25); border-radius:.35rem; padding:.1rem .4rem; font-size:.8rem; margin-right:.25rem; background: rgba(255,255,255,.12);
}

/* Effet hover principal */
.card:hover .card__media img{
  transform: scale(1.05);
  filter: saturate(1.06) brightness(1.02);
  box-shadow: var(--shadow-md);
}
.card:hover .card__overlay{
  opacity: 1; transform: translateY(0);
}

/* Footer */
.site-footer{ padding-block: var(--space-5); color: var(--text-muted); }
.footer__inner{ display:grid; gap:var(--space-2); }
.footer__nav{ display:flex; flex-wrap:wrap; gap:.75rem 1rem; }
.footer__nav a{ color: var(--text-muted); }
.footer__nav a:hover{ color: var(--text); }
.footer__copy{ margin:0; }

/* Breakpoints globaux */
@media (min-width: 480px){
  .nav{ display:flex; }
  .search__input{ width:14ch; }
}
@media (min-width: 640px){
  .only-desktop{ display:inline-flex; }
}

/* UX: élargissement léger sur focus */
.search__input{ transition: width var(--dur-mid) var(--ease); }
@media (min-width:640px){ .search__input:focus{ width:22ch; } }

/* ============================
   PAGE / CONTENU GÉNÉRAL
============================ */
.page__content{ display:grid; gap:var(--space-6); padding-bottom: var(--space-6); }

/* HERO */
.hero{ position:relative; min-height: 56vh; display:grid; align-items:end; }
.hero__media{
  position:absolute; inset:0;
  background: linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.85)), var(--hero-img) center/cover no-repeat;
  filter: saturate(1.05) contrast(1.02) brightness(.95);
  transform: scale(1.02);
}
/* Overlay additionnel pour affiner le voile par thème */
.hero__media::after{
  content:""; position:absolute; inset:0;
  background: linear-gradient(
    180deg,
    rgba(0,0,0,.10) 0%,
    rgba(0,0,0,.30) 40%,
    rgba(0,0,0,.88) 100%
  );
}
/* Variante claire (dégradé blanc translucide) */
@media (prefers-color-scheme: light){
  .hero__media::after{
    background: linear-gradient(
      180deg,
      rgba(255,255,255,.08) 0%,
      rgba(255,255,255,.18) 40%,
      rgba(255,255,255,.36) 100%
    );
  }
}
/* Si système dark mais switch => clair forcé */
@media (prefers-color-scheme: dark){
  html:has(#theme-switch:checked) .hero__media::after{
    background: linear-gradient(
      180deg,
      rgba(255,255,255,.08) 0%,
      rgba(255,255,255,.18) 40%,
      rgba(255,255,255,.36) 100%
    );
  }
}
/* Si système light mais switch => sombre forcé */
@media (prefers-color-scheme: light){
  html:has(#theme-switch:checked) .hero__media::after{
    background: linear-gradient(
      180deg,
      rgba(0,0,0,.10) 0%,
      rgba(0,0,0,.30) 40%,
      rgba(0,0,0,.88) 100%
    );
  }
}

.hero__content{ position:relative; padding-block: var(--space-6); z-index:1; color:#fff; }
.hero__title{ font-size: clamp(2rem, 1.5rem + 2vw, 3rem); margin: 0 0 .25rem; display:flex; align-items:center; gap:.5rem; }
.hero__title .badge{ font-size: .9rem; font-weight: 800; background: rgba(255,255,255,.2); padding:.1rem .5rem; border-radius:.35rem; }
.hero__meta{ margin:.25rem 0 1rem; color:#cfd3d6; }
.hero__desc{ margin:0 0 1rem; max-width: 68ch; color:#e9ecef; }
.hero__actions{ display:flex; gap:.5rem; }

/* ROWS (rails horizontaux) */
.row{ display:grid; gap: var(--space-3); }
.row__head{ display:flex; align-items:baseline; justify-content:space-between; }
.row__title{ margin:0; font-size: var(--fs-3); }
.row__cta{ color: var(--text-muted); font-weight:700; }
.row__grid{ display:grid; grid-auto-flow: column; grid-auto-columns: var(--tile-w); gap: .75rem; overflow-x:auto; scroll-snap-type: x proximity; padding-bottom:.25rem; }
.row__grid > *{ scroll-snap-align: start; }

/* TOP 10 – cartes 2:3 + numéro */
.row__grid .card--ranked{ display:grid; grid-template-columns:auto 1fr; gap:.5rem; align-items:end; }
.row__grid .card--ranked .card__media img{ width: 120px; aspect-ratio: 2/3; }
.row__grid .card--ranked .card__rank{
  font-size: 7rem; line-height: .8; font-weight: 900; letter-spacing: -2px;
  -webkit-text-stroke: 6px #444; color: transparent; filter: drop-shadow(0 6px 16px rgba(0,0,0,.6));
}

/* DÉTAILS (page movie) – quelques bases communes si besoin */
.detail-hero{ position:relative; min-height: 48vh; display:grid; align-items:end; }
.detail-hero::before{
  content:""; position:absolute; inset:0;
  background: linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.85)), var(--backdrop) center/cover no-repeat;
  filter: saturate(1.05) contrast(1.02) brightness(.92);
}
.detail-hero__content{ position:relative; padding-block: var(--space-6); color:#fff; }
.detail-hero__title, .detail__title{ margin:0; font-size: clamp(2rem, 1.4rem + 2.2vw, 3.2rem); }
.detail-hero__meta, .detail__meta{ margin:.25rem 0 1rem; color:#cfd3d6; }
.detail-hero__desc, .detail__desc{ margin:0 0 1rem; max-width:68ch; color:#e9ecef; }
.detail-hero__actions, .detail__actions{ display:flex; gap:.5rem; }

.detail-grid{ display:grid; grid-template-columns: 1fr; gap: var(--space-4); }
.panel{ background: var(--bg-elev); border:1px solid rgba(255,255,255,.08); border-radius:.6rem; padding: var(--space-3); box-shadow: var(--shadow-sm); }
.panel__title{ margin:0 0 .75rem; font-size: var(--fs-2); }
.episodes{ display:grid; gap: .75rem; }
.episode{ display:grid; grid-template-columns: 180px 1fr; gap: .75rem; align-items:start; }
.episode__thumb img{ width:100%; height:auto; border-radius:.4rem; box-shadow:var(--shadow-sm); }
.episode__head{ display:flex; align-items:baseline; gap:.5rem; }
.episode__title{ margin:0; font-size:1.05rem; }
.episode__durée{ color: var(--text-muted); font-variant-numeric: tabular-nums; }
.episode__desc{ margin:.35rem 0 0; color: var(--text-muted); }

.cast{ list-style:none; padding:0; margin:0 0 var(--space-3); display:grid; gap:.5rem; }
.cast__item{ display:grid; grid-template-columns: 48px 1fr; gap:.5rem; align-items:center; }
.cast__item img{ width:48px; height:48px; border-radius:999px; object-fit:cover; }

.details{ display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:.5rem 1rem; }
.details dt{ color:var(--text-muted); }
.details dd{ margin:0; }

/* Breakpoints de rangées */
@media (min-width: 520px){
  :root{ --tile-w: var(--tile-w-sm); }
}
@media (min-width: 768px){
  :root{ --tile-w: var(--tile-w-md); }
}
@media (min-width: 1024px){
  :root{ --tile-w: var(--tile-w-lg); }
  .row__grid .card--ranked .card__media img{ width: 140px; }
  .row__grid .card--ranked .card__rank{ font-size: 8rem; }
}
@media (min-width: 1280px){
  :root{ --tile-w: var(--tile-w-xl); }
  .row__grid .card--ranked .card__media img{ width: 160px; }
  .row__grid .card--ranked .card__rank{ font-size: 9rem; }
}

/* A11y & motion */
@media (prefers-reduced-motion: reduce){
  .hero__media::after, .card__media img, .row__grid > * { transition: none !important; animation: none !important; }
}

/* =============================
   Toggle thème 100% CSS (sans JS)
   — Suit le système par défaut ; #theme-switch:checked inverse.
============================= */
.visually-hidden{
  position:absolute !important;
  width:1px;height:1px;
  padding:0;margin:-1px;
  overflow:hidden;clip:rect(0 0 0 0);
  white-space:nowrap;border:0;
}

.theme-toggle .icon::before{ content:""; display:inline-block; }

/* Icône selon le système (affiche l'action possible) */
@media (prefers-color-scheme: dark){
  .theme-toggle .icon::before{ content:"☀️"; }
}
@media (prefers-color-scheme: light){
  .theme-toggle .icon::before{ content:"🌙"; }
}

/* Thème clair quand système clair (réutilise ta palette claire) */
@media (prefers-color-scheme: light){
  :root{
    --bg:#f9fafb; --bg-elev:#fff; --bg-muted:#f1f5f9;
    --text:#0b0b0f; --text-muted:#475569;
  }
}

/* Inversion quand le switch est coché */
@media (prefers-color-scheme: dark){
  html:has(#theme-switch:checked){
    --bg:#f9fafb; --bg-elev:#fff; --bg-muted:#f1f5f9;
    --text:#0b0b0f; --text-muted:#475569;
  }
  html:has(#theme-switch:checked) .theme-toggle .icon::before{ content:"🌙"; }
}
@media (prefers-color-scheme: light){
  html:has(#theme-switch:checked){
    /* on force la palette sombre (déjà définie en :root plus haut) */
    --bg:#141414; --bg-elev:#1b1bf1; /* léger foncé constant */
    --bg-muted:#0f0f12;
    --text:#f5f7fa; --text-muted:#98a2b3;
  }
  html:has(#theme-switch:checked) .theme-toggle .icon::before{ content:"☀️"; }
}

/* Accessibilité focus + UX recherche (sans toucher au reste) */
:focus-visible{ outline:2px solid #60a5fa; outline-offset:2px; }
.search__input{ transition: width var(--dur-mid,260ms) var(--ease,cubic-bezier(.22,.61,.36,1)); }
@media (min-width:640px){ .search__input:focus{ width:22ch; } }
